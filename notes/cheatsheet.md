## 【速查表】M1-W3-D3：ruff 格式化与静态检查



```
┌─────────────────────────────────────────────────────────────┐
│                    ruff 核心命令                             │
├─────────────────────────────────────────────────────────────┤
│  安装                                                        │
│  uv add --dev ruff                                          │
├─────────────────────────────────────────────────────────────┤
│  检查代码问题（不修改）                                        │
│  uv run ruff check src                                      │
├─────────────────────────────────────────────────────────────┤
│  检查并自动修复                                               │
│  uv run ruff check src --fix                                │
├─────────────────────────────────────────────────────────────┤
│  格式化代码风格                                               │
│  uv run ruff format src                                     │
├─────────────────────────────────────────────────────────────┤
│  只检查格式，不修改                                           │
│  uv run ruff format src --check                             │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                    pyproject.toml 配置                       │
├─────────────────────────────────────────────────────────────┤
│  [tool.ruff]                                                │
│  line-length = 88        # 每行最大字符数                     │
│  src = ["src"]           # 源码目录                          │
│                                                             │
│  [tool.ruff.lint]                                           │
│  select = ["E", "F", "I"]  # 启用的检查规则                   │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                    常见错误码                                 │
├─────────────────────────────────────────────────────────────┤
│  E = 代码风格错误（如 E501 行太长）                            │
│  F = 逻辑错误（如 F401 未使用的 import）                       │
│  I = import 排序问题（如 I001 排序不对）                       │
├─────────────────────────────────────────────────────────────┤
│  [*] 标记 = 可自动修复                                        │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                    check vs format                          │
├─────────────────────────────────────────────────────────────┤
│  ruff check   → 检查代码问题（未使用变量、错误逻辑）            │
│  ruff format  → 统一代码风格（空格、缩进、引号）               │
└─────────────────────────────────────────────────────────────┘
```

---

## M1-W3-D4 速查表

### 类型检查

uv run pyright src

### 可选类型（允许 None）

email: str | None = None
email: Optional[str] = None  # 旧写法

### Optional vs 默认值

Optional[str]        → 控制"允许什么值"（str 或 None）
= None               → 控制"是否必须传"
这两个是独立的！

### pyright 配置文件

pyrightconfig.json

---

