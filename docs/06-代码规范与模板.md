# ä»£ç è§„èŒƒä¸æ¨¡æ¿

## ğŸ¯ ç›®çš„
ç»Ÿä¸€ä»£ç é£æ ¼ï¼Œç§¯ç´¯å¸¸ç”¨æ¨¡æ¿ï¼Œæé«˜å¼€å‘æ•ˆç‡

---

## ğŸ“‹ Python ä»£ç è§„èŒƒ

### å‘½åè§„èŒƒ

```python
# å˜é‡å’Œå‡½æ•°ï¼šsnake_case
user_name = "é¡¾æ¸…æ­Œ"
def get_user_info():
    pass

# ç±»åï¼šPascalCase
class ChatBot:
    pass

# å¸¸é‡ï¼šUPPER_SNAKE_CASE
MAX_TOKENS = 4000
API_BASE_URL = "https://api.openai.com"

# ç§æœ‰å˜é‡/æ–¹æ³•ï¼šå‰ç¼€ä¸‹åˆ’çº¿
_internal_cache = {}
def _validate_input():
    pass
```

### æ–‡ä»¶ç»“æ„

```python
"""
æ¨¡å—æ–‡æ¡£å­—ç¬¦ä¸²
æè¿°è¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨
"""

# 1. æ ‡å‡†åº“å¯¼å…¥
import os
import json
from typing import List, Dict

# 2. ç¬¬ä¸‰æ–¹åº“å¯¼å…¥
import requests
from openai import OpenAI

# 3. æœ¬åœ°æ¨¡å—å¯¼å…¥
from .utils import logger
from .config import settings

# 4. å¸¸é‡å®šä¹‰
MAX_RETRIES = 3

# 5. ç±»å®šä¹‰
class MyClass:
    pass

# 6. å‡½æ•°å®šä¹‰
def my_function():
    pass

# 7. ä¸»ç¨‹åºå…¥å£
if __name__ == "__main__":
    main()

```

### æ³¨é‡Šè§„èŒƒ

```python
def complex_function(param1: str, param2: int) -> Dict:
    """
    å‡½æ•°çš„ç®€çŸ­æè¿°ï¼ˆä¸€å¥è¯ï¼‰
    
    è¯¦ç»†æè¿°å‡½æ•°çš„ä½œç”¨ã€é€»è¾‘ã€æ³¨æ„äº‹é¡¹
    
    Args:
        param1: å‚æ•°1çš„è¯´æ˜
        param2: å‚æ•°2çš„è¯´æ˜
    
    Returns:
        è¿”å›å€¼çš„è¯´æ˜
    
    Raises:
        ValueError: ä»€ä¹ˆæƒ…å†µä¸‹æŠ›å‡º
    
    Example:
        >>> complex_function("test", 123)
        {"result": "success"}
    """
    pass

```

## ğŸ”§ å¸¸ç”¨ä»£ç æ¨¡æ¿

### 1. API è°ƒç”¨åŸºç¡€æ¨¡æ¿

```python
import requests
from typing import Dict, Optional
import time

class APIClient:
    """API å®¢æˆ·ç«¯åŸºç¡€ç±»"""
    
    def __init__(self, api_key: str, base_url: str):
        self.api_key = api_key
        self.base_url = base_url
        self.session = requests.Session()
        self.session.headers.update({
            "Authorization": f"Bearer {api_key}",
            "Content-Type": "application/json"
        })
    
    def _make_request(
        self, 
        endpoint: str, 
        method: str = "POST",
        data: Optional[Dict] = None,
        max_retries: int = 3
    ) -> Dict:
        """
        å‘é€ API è¯·æ±‚ï¼ˆå¸¦é‡è¯•ï¼‰
        
        Args:
            endpoint: API ç«¯ç‚¹
            method: HTTP æ–¹æ³•
            data: è¯·æ±‚æ•°æ®
            max_retries: æœ€å¤§é‡è¯•æ¬¡æ•°
        
        Returns:
            API å“åº”æ•°æ®
        """
        url = f"{self.base_url}/{endpoint}"
        
        for attempt in range(max_retries):
            try:
                response = self.session.request(
                    method=method,
                    url=url,
                    json=data,
                    timeout=30
                )
                response.raise_for_status()
                return response.json()
                
            except requests.exceptions.RequestException as e:
                if attempt == max_retries - 1:
                    raise
                
                # æŒ‡æ•°é€€é¿
                wait_time = 2 ** attempt
                time.sleep(wait_time)
                
        return {}

```

### 2. å¤§æ¨¡å‹ API è°ƒç”¨æ¨¡æ¿

```python
from openai import OpenAI
from typing import List, Dict

class ChatBot:
    """èŠå¤©æœºå™¨äººåŸºç¡€ç±»"""
    
    def __init__(self, api_key: str, model: str = "gpt-4"):
        self.client = OpenAI(api_key=api_key)
        self.model = model
        self.messages: List[Dict] = []
    
    def chat(self, user_message: str) -> str:
        """
        å‘é€æ¶ˆæ¯å¹¶è·å–å›å¤
        
        Args:
            user_message: ç”¨æˆ·æ¶ˆæ¯
        
        Returns:
            AI å›å¤
        """
        # æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°å†å²
        self.messages.append({
            "role": "user",
            "content": user_message
        })
        
        # è°ƒç”¨ API
        response = self.client.chat.completions.create(
            model=self.model,
            messages=self.messages,
            temperature=0.7,
            max_tokens=1000
        )
        
        # æå–å›å¤
        assistant_message = response.choices[0].message.content
        
        # æ·»åŠ åˆ°å†å²
        self.messages.append({
            "role": "assistant",
            "content": assistant_message
        })
        
        return assistant_message
    
    def clear_history(self):
        """æ¸…ç©ºå¯¹è¯å†å²"""
        self.messages = []

```

### 3. å¼‚å¸¸å¤„ç†æ¨¡æ¿

```python
import logging
from functools import wraps

logger = logging.getLogger(__name__)

def handle_errors(func):
    """é”™è¯¯å¤„ç†è£…é¥°å™¨"""
    @wraps(func)
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            logger.error(
                f"Error in {func.__name__}: {str(e)}",
                exc_info=True
            )
            raise
    return wrapper

@handle_errors
def risky_function():
    """å¯èƒ½å‡ºé”™çš„å‡½æ•°"""
    pass

```

### 4. é…ç½®ç®¡ç†æ¨¡æ¿

```python
from dataclasses import dataclass
from typing import Optional
import os
from dotenv import load_dotenv

load_dotenv()

@dataclass
class Config:
    """åº”ç”¨é…ç½®"""
    
    # API é…ç½®
    api_key: str = os.getenv("OPENAI_API_KEY", "")
    api_base: str = os.getenv("API_BASE_URL", "https://api.openai.com")
    
    # æ¨¡å‹é…ç½®
    model: str = "gpt-4"
    temperature: float = 0.7
    max_tokens: int = 1000
    
    # åº”ç”¨é…ç½®
    debug: bool = os.getenv("DEBUG", "False").lower() == "true"
    log_level: str = os.getenv("LOG_LEVEL", "INFO")
    
    def validate(self) -> bool:
        """éªŒè¯é…ç½®"""
        if not self.api_key:
            raise ValueError("API key is required")
        return True

# å…¨å±€é…ç½®å®ä¾‹
config = Config()
config.validate()

```

### 5. æ—¥å¿—ç³»ç»Ÿæ¨¡æ¿

```python
import logging
from pathlib import Path

def setup_logger(
    name: str,
    log_file: Optional[str] = None,
    level: str = "INFO"
) -> logging.Logger:
    """
    è®¾ç½®æ—¥å¿—ç³»ç»Ÿ
    
    Args:
        name: Logger åç§°
        log_file: æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰
        level: æ—¥å¿—çº§åˆ«
    
    Returns:
        é…ç½®å¥½çš„ Logger
    """
    logger = logging.getLogger(name)
    logger.setLevel(getattr(logging, level.upper()))
    
    # æ ¼å¼åŒ–
    formatter = logging.Formatter(
        '%(asctime)s - %(name)s - %(levelname)s - %(message)s',
        datefmt='%Y-%m-%d %H:%M:%S'
    )
    
    # æ§åˆ¶å°è¾“å‡º
    console_handler = logging.StreamHandler()
    console_handler.setFormatter(formatter)
    logger.addHandler(console_handler)
    
    # æ–‡ä»¶è¾“å‡ºï¼ˆå¦‚æœæŒ‡å®šï¼‰
    if log_file:
        Path(log_file).parent.mkdir(parents=True, exist_ok=True)
        file_handler = logging.FileHandler(log_file, encoding='utf-8')
        file_handler.setFormatter(formatter)
        logger.addHandler(file_handler)
    
    return logger

# ä½¿ç”¨
logger = setup_logger(__name__, "logs/app.log")
logger.info("Application started")

```

## ğŸ“ é¡¹ç›®ç»“æ„æ¨¡æ¿

### æ ‡å‡†é¡¹ç›®ç»“æ„

```python
project_name/
â”œâ”€â”€ README.md              # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ requirements.txt       # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ .env.example          # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore            # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ setup.py              # åŒ…å®‰è£…é…ç½®
â”œâ”€â”€ tests/                # æµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_api.py
â”‚   â””â”€â”€ test_utils.py
â”œâ”€â”€ src/                  # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py          # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ config.py        # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ models/          # æ¨¡å‹/æ•°æ®ç±»
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ chatbot.py
â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ logger.py
â”‚   â”‚   â””â”€â”€ helpers.py
â”‚   â””â”€â”€ services/        # æœåŠ¡å±‚
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ api_client.py
â”œâ”€â”€ data/                # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/
â”‚   â””â”€â”€ processed/
â”œâ”€â”€ logs/                # æ—¥å¿—ç›®å½•
â””â”€â”€ notebooks/           # Jupyter notebooks
    â””â”€â”€ exploration.ipynb

```

## ğŸ§ª æµ‹è¯•æ¨¡æ¿

### å•å…ƒæµ‹è¯•æ¨¡æ¿

```python
import pytest
from src.models.chatbot import ChatBot

class TestChatBot:
    """ChatBot æµ‹è¯•ç±»"""
    
    @pytest.fixture
    def chatbot(self):
        """æµ‹è¯•å¤¹å…·ï¼šåˆ›å»º ChatBot å®ä¾‹"""
        return ChatBot(api_key="test_key")
    
    def test_chat_adds_message_to_history(self, chatbot):
        """æµ‹è¯•ï¼šå‘é€æ¶ˆæ¯åå†å²è®°å½•å¢åŠ """
        initial_len = len(chatbot.messages)
        chatbot.chat("Hello")
        assert len(chatbot.messages) == initial_len + 2  # user + assistant
    
    def test_clear_history(self, chatbot):
        """æµ‹è¯•ï¼šæ¸…ç©ºå†å²"""
        chatbot.chat("Hello")
        chatbot.clear_history()
        assert len(chatbot.messages) == 0

```

